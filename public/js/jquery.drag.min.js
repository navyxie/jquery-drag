var NAVY=NAVY||{};NAVY.Drag=function(e,t,n){var r,i;this.orignSelf=e,this.orignTarget=t,e===t?e=t=$(e):(e=$(e),t=$(t)),r={left:0,top:0,limitObj:t.offsetParent()||"body",isMoveSpace:{x:3,y:3},isClearMargin:!0},this.jqObj=e,this.targetObj=t,this.opts=$.extend(r,n),i=$(this.opts.limitObj),this.limitObjWidth=i.outerWidth(),this.limitObjHeight=i.outerHeight(),this.opts.isClearMargin&&this.targetObj.css("margin","0"),this.setMaxvalue(),this.init()},NAVY.Drag.prototype={init:function(){var e=this.targetObj,t=this.jqObj,n=this.opts;return t.css({cursor:"move"}),e.css({position:"absolute",left:n.left,top:n.top}),this.initEvent(),this},initEvent:function(){var e,t,n=this,r=this.jqObj,i=this.targetObj,s=this.opts,o=!1,u={x:0,y:0},a={left:s.left,top:s.top};return s.limitObj.find(n.orignSelf).mousedown(function(r){return o=!0,n.orignSelf===n.orignTarget?i=$(this):i=$(this).closest(n.orignTarget),n.setMaxvalue(i),e=n.maxMove.x,t=n.maxMove.y,u.x=r.pageX,u.y=r.pageY,a.left=i.position().left,a.top=i.position().top,NAVY.UTIL.Style.setMaxZIndex(i[0]),!1}),$(document).on("mousemove mouseup",function(n){var r,f,l,c,h;switch(n.type){case"mouseup":return o=!1,!1;case"mousemove":if(o){r={x:n.pageX,y:n.pageY},f=r.x-u.x,l=r.y-u.y;if(f%s.isMoveSpace.x===0||l%s.isMoveSpace.y===0)c=a.left+f,h=a.top+l,c=c<=0?0:c>e?e:c,h=h<=0?0:h>t?t:h,i.css({left:c,top:h})}return!1}}),this},getStyle:function(){var e=this.targetObj;return{left:e.css("left"),top:e.css("top"),zIndex:e.css("z-index")}},unDrag:function(e,t){return e=e||this.jqObj,t=t||this.targetObj,e.css({cursor:"default"}).unbind(),t.css({position:"",left:"",top:""}),this},setMaxvalue:function(e){var t,n,r,i,s=this.opts;e=e||this.targetObj,this.maxMove={x:this.limitObjWidth-e.outerWidth(),y:this.limitObjHeight-e.outerHeight()},s.isClearMargin||(t=e.css("marginLeft"),n=e.css("marginRight"),r=e.css("marginTop"),i=e.css("marginBottom"),this.maxMove.x=this.limitObjWidth-e.outerWidth()-parseInt(n)-parseInt(t),this.maxMove.y=this.limitObjHeight-e.outerHeight()-parseInt(r)-parseInt(i))}}