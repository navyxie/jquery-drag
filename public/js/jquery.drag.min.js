var NAVY=NAVY||{};NAVY.Drag=function(t,i,s){this.orignSelf=t,this.orignTarget=i,t===i?t=i=$(t):(t=$(t),i=$(i));var e={left:0,top:0,limitObj:i.offsetParent()||"body",isMoveSpace:{x:3,y:3},isClearMargin:!0};this.jqObj=t,this.targetObj=i,this.opts=$.extend(e,s);var r=$(this.opts.limitObj);this.limitObjWidth=r.outerWidth(),this.limitObjHeight=r.outerHeight(),this.opts.isClearMargin&&this.targetObj.css("margin","0"),this.setMaxvalue(),this.init()},NAVY.Drag.prototype={init:function(){var t=this.targetObj,i=this.jqObj,s=this.opts;return i.css({cursor:"move"}),t.css({position:"absolute",left:s.left,top:s.top}),this.initEvent(),this},initEvent:function(){var t,i,s=this,e=this.targetObj,r=this.opts,h=!1,o={x:0,y:0},a={left:r.left,top:r.top};return r.limitObj.find(s.orignSelf).mousedown(function(r){return h=!0,e=s.orignSelf===s.orignTarget?$(this):$(this).closest(s.orignTarget),s.setMaxvalue(e),t=s.maxMove.x,i=s.maxMove.y,o.x=r.pageX,o.y=r.pageY,a.left=e.position().left,a.top=e.position().top,NAVY.UTIL.Style.setMaxZIndex(e[0]),!1}),$(document).on("mousemove mouseup",function(s){switch(s.type){case"mouseup":return h=!1,!1;case"mousemove":if(h){var n={x:s.pageX,y:s.pageY},d=n.x-o.x,p=n.y-o.y;if(0===d%r.isMoveSpace.x||0===p%r.isMoveSpace.y){var g=a.left+d,l=a.top+p;g=0>=g?0:g>t?t:g,l=0>=l?0:l>i?i:l,e.css({left:g,top:l})}}return!1}}),this},getStyle:function(){var t=this.targetObj;return{left:t.css("left"),top:t.css("top"),zIndex:t.css("z-index")}},unDrag:function(t,i){return t=t||this.jqObj,i=i||this.targetObj,t.css({cursor:"default"}).unbind(),i.css({position:"",left:"",top:""}),this},setMaxvalue:function(t){var i=this.opts;if(t=t||this.targetObj,this.maxMove={x:this.limitObjWidth-t.outerWidth(),y:this.limitObjHeight-t.outerHeight()},!i.isClearMargin){var s=t.css("marginLeft"),e=t.css("marginRight"),r=t.css("marginTop"),h=t.css("marginBottom");this.maxMove.x=this.limitObjWidth-t.outerWidth()-parseInt(e)-parseInt(s),this.maxMove.y=this.limitObjHeight-t.outerHeight()-parseInt(r)-parseInt(h)}},setCursorDefault:function(){this.jqObj.css({cursor:"default"})},setCursorMove:function(){this.jqObj.css({cursor:"move"})}};